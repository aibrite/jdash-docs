<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <link rel="canonical" href="http://doc.jdash.io/backend/nodejs-dev/"> 
    <link rel="shortcut icon" href="../../img/favicon.ico">

    <title>NodeJS Development - JDash</title>

    <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/font-hack/2.018/css/hack.min.css">
    <link href='//fonts.googleapis.com/css?family=PT+Sans:400,400italic,700,700italic&subset=latin-ext,latin' rel='stylesheet'
        type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin'
            rel='stylesheet' type='text/css'>
            <link href="../../css/base.css" rel="stylesheet">
            <link href="../../css/cinder.css" rel="stylesheet">
            <link rel="stylesheet" href="../../css/highlight.css">

            <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
            <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

            <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
            <script>
                WebFont.load({
                    google: {
                        families: ['Open Sans', 'PT Sans']
                    }
                });
            </script>

            
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../..">JDash</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../..">Home</a>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Client Development <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../client/">Client Home</a>
</li>

                        
                            
<li >
    <a href="../../client/getting-started/">Getting Started</a>
</li>

                        
                            
<li >
    <a href="../../client/basic-concepts/">Basic Concepts</a>
</li>

                        
                            
<li >
    <a href="../../client/working-with-providers/">Providers</a>
</li>

                        
                            
<li >
    <a href="../../client/working-with-dashboards/">Working with Dashboards</a>
</li>

                        
                            
<li >
    <a href="../../client/dashlet-development/">Dashlet Development</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Backend Development <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../">Backend Home</a>
</li>

                        
                            
<li class="active">
    <a href="./">NodeJS Development</a>
</li>

                        
                            
<li >
    <a href="../net-core-dev/">Net Core Development</a>
</li>

                        
                            
<li >
    <a href="../jdash-cloud/">JDash Cloud</a>
</li>

                        
                        </ul>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                    <li >
                        <a rel="next" href="../">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../net-core-dev/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                
                
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="first-level active"><a href="#nodejs-development">NodeJS Development</a></li>
        
            <li class="second-level"><a href="#step-1-initial-setup">Step 1: Initial setup</a></li>
            
                <li class="third-level"><a href="#basic-server-application">Basic server application</a></li>
            
        
            <li class="second-level"><a href="#step-2-attaching-jdash-express-middleware-to-your-application">Step 2: Attaching jdash-express middleware to your application</a></li>
            
                <li class="third-level"><a href="#setting-a-principal-and-application-name">Setting a principal and application name</a></li>
            
                <li class="third-level"><a href="#using-providers">Using providers</a></li>
            
        
            <li class="second-level"><a href="#step-3-client-side-development">Step 3: Client side development</a></li>
            
                <li class="third-level"><a href="#step-4-develop-your-first-dashlet">Step 4: Develop your first dashlet</a></li>
            
                <li class="third-level"><a href="#step-5-create-and-display-dashboard">Step 5: Create and display dashboard</a></li>
            
                <li class="third-level"><a href="#step-6-view-dashboards">Step 6: View dashboards</a></li>
            
                <li class="third-level"><a href="#step-7-download-source-code">Step 7: Download source code</a></li>
            
        
    
    </ul>
</div></div>
        <div class="col-md-9" role="main">

<h1 id="nodejs-development">NodeJS Development</h1>
<p>This article is about installing and using JDash NodeJs packages on your backend. </p>
<p>If you want to use JDash Cloud to store and manage dashboard related data you can continue from <a href="../../client/getting-started/">Getting Started</a> section.</p>
<h2 id="step-1-initial-setup">Step 1: Initial setup</h2>
<p>Use npm to install JDash NodeJs packages.</p>
<pre><code class="no-highlight">npm install jdash-express --save
</code></pre>

<p>Note: If this is the first time you use npm to add a package, first execute <code>npm init</code> to create a <code>package.json</code>.</p>
<p>Jdash uses <a target="_blank" href="http://expressjs.com">Express</a>. Express is a minimal and flexible Node.js web application framework that provides a robust set of features for web and mobile applications.</p>
<h3 id="basic-server-application">Basic server application</h3>
<p>Below code snippet creates a simple NodeJs application, which serves static files from root folder.</p>
<pre><code class="javascript">var express = require('express');
var bodyParser = require('body-parser');

// Create an app
var app = express();

app.use(bodyParser.json());
app.use(bodyParser.urlencoded({ extended: false }));
app.use(express.static(__dirname));


// Start listening port 3001
app.listen(3001, function () {

})
</code></pre>

<h2 id="step-2-attaching-jdash-express-middleware-to-your-application">Step 2: Attaching jdash-express middleware to your application</h2>
<pre><code class="javascript">var jexpress = require('jdash-express').default;

// create a router for jdash
var jdashRoutes = express.Router();

// jexpress acts as a middleware for specified route.
// configure jexpress with router and user callback
jexpress({
    principal: function (request) {
        return {
            user: &quot;current-user&quot;, // username which makes this request
            appid: &quot;myapp&quot; // application id of this app
        }
    },
    provider: null // we will explain provider details later.
}).use(jdashRoutes);

// Use this router
app.use('/jdash/api/v1', jdashRoutes);

app.listen(3001, function () {

})
</code></pre>

<h3 id="setting-a-principal-and-application-name">Setting a principal and application name</h3>
<p>Use <code>principal</code> property of <code>jexpress</code> configuration object to get user from current request. This value is used to set the user name property of dashboards and dashlets inside database, so that each user can have their own dashboards and dashlets.</p>
<p>You also need to provide an application name. Application name allows to use same database instance for different applications. </p>
<h3 id="using-providers">Using providers</h3>
<p>Providers are NodeJs packages which allows to retrieve and persist dashboard data i.e. dashlet configurations, layouts and so on.</p>
<p>Currently JDash has two built-in NodeJs packages for MongoDB and MySQL.</p>
<h4 id="using-mongodb-with-jdash">Using MongoDB with Jdash</h4>
<p>Use npm to install JDash MongoDb for NodeJs package.</p>
<pre><code class="no-highlight">npm install jdash-mongodb --save
</code></pre>

<pre><code class="typescript">var mongoose = require('mongoose');
var jmongo = require('jdash-mongodb').default;

var connStr = 'Your connection string goes here';

// Create a database connection
var connection = mongoose.createConnection(connStr);

// Configure Jdash when database connection is ready.
connection.on('connected', function () {
    jexpress({
        principal: function (request) {
            return {
                user: &quot;current-user&quot;, 
                appid: &quot;myapp&quot; 
            }
        },
        // Set provider
        provider: jmongo({
            connection: connection
        })
    }).use(jdashRoutes);
})
</code></pre>

<h4 id="using-mysql-with-jdash">Using MySQL with Jdash</h4>
<p>Use npm to install JDash MySQL Provider.</p>
<pre><code class="no-highlight">npm install jdash-mysqldb --save
</code></pre>

<pre><code class="typescript">var mysql = require('mysql');
var jmysql = require('jdash-mysqldb').default;

// Create a database connection
var connection = mysql.createPool({
    connectionLimit: 100,
    host: 'localhost',
    port: 3306,
    user: 'root',
    password: '1234',
    database: 'jdash_local'
});

jexpress({
        principal: function (request) {
            return {
                user: &quot;current-user&quot;, 
                appid: &quot;myapp&quot; 
            }
        },
        provider: jmysql({
            connection: connection
        })
}).use(jdashRoutes);
</code></pre>

<h2 id="step-3-client-side-development">Step 3: Client side development</h2>
<p>Use npm to install JDash UI package.</p>
<pre><code class="no-highlight">npm install jdash-ui --save
</code></pre>

<p>This will create <code>node_modules/jdash-ui</code> folder.</p>
<p>Create index.html inside your project root and paste below code.</p>
<pre><code class="html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;

&lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;initial-scale=1, maximum-scale=1, user-scalable=no&quot; /&gt;
    &lt;title&gt;JDash Tutorial&lt;/title&gt;

    &lt;!-- jdash client library --&gt;
    &lt;script src=&quot;node_modules/jdash-ui/dist/jdash.min.js&quot;&gt;&lt;/script&gt;

    &lt;!-- jdash theme &amp; elements --&gt;
    &lt;link rel=&quot;import&quot; href=&quot;node_modules/jdash-ui/dist/components/jdash.html&quot;&gt;
&lt;/head&gt;

&lt;body class=&quot;j-light-gray j-padding&quot;&gt;

&lt;/body&gt;

&lt;/html&gt;
</code></pre>

<h3 id="step-4-develop-your-first-dashlet">Step 4: Develop your first dashlet</h3>
<p>You use <code>j-dashlet</code> element to define a dashlet. </p>
<p>Content of <code>j-dashlet</code> can include <code>template</code> element which can be used to define dom (innerHTML) of your dashlet. An optional <code>script</code> element inside <code>j-dashlet</code> can be used to execute javascript for this dashlet. </p>
<p>Copy the following code inside body tag. </p>
<pre><code class="html">&lt;!-- Define &lt;hello-world&gt; dashlet --&gt;
&lt;j-dashlet id=&quot;hello-world&quot; title=&quot;Hello world!&quot;&gt;
    &lt;template&gt;
        &lt;!-- This will be the HTML content of your dashlet  --&gt;
        &lt;h1&gt;&lt;/h1&gt;
    &lt;/template&gt;
    &lt;script&gt;
        jdash.define(function () {

            this.initialized = function () {
                // Dom is ready!
                var h1 = this.querySelector('h1')
                h1.textContent = 'Hello World!';
            }

        })
    &lt;/script&gt;
&lt;/j-dashlet&gt;
</code></pre>

<h3 id="step-5-create-and-display-dashboard">Step 5: Create and display dashboard</h3>
<p>Use <code>j-dashboard</code> element to display a dashboard. </p>
<p>Inside <code>body</code> tag add following code.</p>
<pre><code class="html">    &lt;button id=&quot;createDashboardBtn&quot;&gt;Create Dashboard&lt;/button&gt;
    &lt;button id=&quot;addDashletBtn&quot;&gt;Add Dashlet&lt;/button&gt;
    &lt;div id=&quot;dashboardList&quot;&gt;&lt;/div&gt;

    &lt;j-dashboard id=&quot;dashboard&quot; j-view-mode=&quot;dashletedit&quot;&gt;
        &lt;h2 j-bind=&quot;title&quot;&gt;&lt;/h2&gt;
    &lt;/j-dashboard&gt;
&lt;/body&gt;
</code></pre>

<p>Add a <code>script</code> element after <code>body</code> and paste below code.</p>
<pre><code class="html">&lt;script&gt;
    jdash.ready(function () {

        // Set provider
        jdash.Provider = new jdash.ProviderTypes.OnPremise({ url: '/jdash/api/v1' }); // define your end point

        // createDashboardList();
        document.querySelector('#createDashboardBtn').addEventListener('click', function () {
            var title = window.prompt('Set a title for new dashboard');

            // Create a new dashboard
            jdash.Provider.createDashboard({
                title: title
            }).then(function (result) {
                console.log('Dashboard created with id:' + result.id);
                dashboard.load(result.id);
                //createDashboardList();
            }).catch(function (err) {
                alert('There was an error creating dashboard: ' + err.message || err)
            })
        })

        // add hello world dashlet to dashboard
        document.querySelector('#addDashletBtn').addEventListener('click', function (e) {
            dashboard.addDashlet('hello-world');
        })
    })
&lt;/script&gt;
&lt;/body&gt;
</code></pre>

<h3 id="step-6-view-dashboards">Step 6: View dashboards</h3>
<p>As the last step, we will implement the code to view existing dashboards.</p>
<p><code>jdash.Provider.getMyDashboards</code> method returns a list of dashboards current user owns. Note that you initialize current credentials by setting a valid value for <code>userToken</code> param for <code>jdash.Provider.init</code> method.</p>
<p>Add following function inside <code>script</code> element.</p>
<pre><code class="javascript">function createDashboardList() {
    var container = document.querySelector('#dashboardList');

    // clear existing buttons.
    container.innerHTML = '';
    return jdash.Provider.getMyDashboards().then(function (result) {

        // for each dashboard create a button
        for (var i = 0; i &lt; result.data.length; i++) {
            var btn = document.createElement('button');
            btn.textContent = result.data[i].title;
            btn.id = result.data[i].id;
            container.appendChild(btn);
            btn.addEventListener('click', function (e) {
                var idToLoad = e.target.id;
                dashboard.load(idToLoad);
            })
        }
    })
}
</code></pre>

<p>Uncomment this function when page loads / user creates a new dashboard so that dashboard list is updated.</p>
<h3 id="step-7-download-source-code">Step 7: Download source code</h3>
<p>Source code of this guide can be found at this <a href="https://github.com/aibrite/jdash-nodejs-tutorial">GitHub Repo</a>.</p>
<p>If you enjoy JDash you can continue from Basic Concepts.</p></div>
        
    </div>

    <footer class="col-md-12 text-center">
        <hr>
        <p>
            <small>&copy; 2017 <a target="_blank" href="http://jdash.io">JDash</a>.</p></small>
    </footer>

    <script src="../../js/jquery-1.10.2.min.js"></script>
    <script src="../../js/bootstrap-3.0.3.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    <script>
                hljs.initHighlightingOnLoad();
    </script>
    <script>
        var base_url = '../..';
    </script>
    <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
    <script src="../../js/base.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>

    </body>

</html>
